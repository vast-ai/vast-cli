openapi: 3.0.0
info:
  title: Create Template API
  description: API endpoint for creating new instance templates
  version: 1.0.0
paths:
  /api/v0/template/:
    post:
      summary: create template
      description: |
        Creates a new template for launching instances.

        CLI Usage: `vastai create template <name> <image> [options]`
      tags:
      - Templates
      security:
      - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - image
              properties:
                name:
                  type: string
                  default: My Template
                  description: Name of the template
                image:
                  type: string
                  default: vastai/base-image
                  description: Docker image path. Used when launching instances from this template.
                tag:
                  type: string
                  default: '@vastai-automatic-tag'
                  description: |
                    Docker image tag specifying version of the image
                    This can be included in the image instead of here
                env:
                  type: object
                  description: |
                    Environment variables

                    Example : `{ "HF_TOKEN": "hf_xxx123456789", "MODEL_ID": "TheBloke/Llama-2-7B-Chat-GPTQ", }`
                onstart:
                  type: string
                  description: |
                    Commands to run when instance starts

                    Example : `env | grep _ >> /etc/environment; echo 'starting up'` 
                runtype:
                  type: string
                  enum:
                  - ssh
                  - jupyter
                  - args
                  description: Type of instance runtime
                ssh_direct:
                  type: boolean
                  description: Enable direct SSH connection
                jup_direct:
                  type: boolean
                  description: Enable direct Jupyter connection
                jupyter_dir:
                  type: string
                  description: |
                    Directory to launch Jupyter from

                    Example : `/home/notebooks`
                use_jupyter_lab:
                  type: boolean
                  description: Use JupyterLab instead of Jupyter Notebook
                docker_login_repo:
                  type: string
                  description: Name of the private Docker repo (i.e docker.io)
                docker_login_user:
                  type: string
                  description: Username for private Docker repo 
                docker_login_pass:
                  type: string
                  description: Access token or password for private Docker repo.
                extra_filters:
                  type: object
                  description: Additional machine search filters
                recommended_disk_space:
                  type: number
                  description: Recommended disk space in GB
            example:
              name: My Template
              image: vastai/base-image
              tag: '@vastai-automatic-tag'
      responses:
        '200':
          description: Template created or existing template found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: Whether operation was successful
                  msg:
                    type: string
                    description: Status message
                    example: "Template Created Successfully! New Template ID: 123456"
                  template:
                    type: object
                    description: Template details
                    properties:
                      name:
                        type: string
                        description: Template name
                      id:
                        type: integer
                        description: Template ID
                      hash_id:
                        type: string
                        description: Template hash identifier
        '400':
          description: Bad request - invalid parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: invalid_args
                  msg:
                    type: string
                    example: Template name is required 
        '429':
          description: Rate limit exceeded
        '401':
          description: Unauthorized - invalid or missing API key
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: Authorization
